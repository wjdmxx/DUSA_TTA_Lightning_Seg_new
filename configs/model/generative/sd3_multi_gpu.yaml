# SD3 Multi-GPU Configuration
# Use this config for distributing SD3 across multiple GPUs
# Default: Discriminative(cuda:0) + VAE(cuda:0) + Transformer(cuda:1)
# Usage: CUDA_VISIBLE_DEVICES=0,1 python scripts/run_tta.py model/generative=sd3_multi_gpu

# HuggingFace model path
model_path: "stabilityai/stable-diffusion-3-medium-diffusers"

# Text prompt template
prompt_template: "a photo of a {}"

# Flow matching timestep
timestep: 0.25

# TopK selection
topk: 1
classes_threshold: 20

# Sliding window
crop_size: [512, 512]
slide_stride: [0, 171]

# VAE on first GPU (cuda:0) - shares GPU with discriminative model
vae_device: "cuda:0"

# Transformer on second GPU (cuda:1) - separate GPU for memory efficiency
# This is the largest component and benefits from dedicated GPU
transformer_device_config:
  device: "cuda:1"

# Gradient checkpointing - reduces memory usage at cost of some speed
gradient_checkpointing: true

# Embeddings cache - speeds up loading on subsequent runs
embeddings_cache_path: "cache/sd3_ade20k_embeddings.pt"
